---
title: "STAT 331 Portfolio"
author: "Lucy Thackray"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: true
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an A.

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1
#Lab 3 Q2

#You are not utilizing the features of an R project! You can load the data based on a **relative** path (from where the project lives) rather than a **full** path.

evals <- read_csv(here::here("Week 3", "teacher_evals.csv"))

```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2
#Lab 2 Q1
surveys<-read_csv(here::here("Week 2", "surveys.csv"))


```

-   `xlsx`

```{r}
#| label: wd-1-xlsx
#PA 4
military <- read_xlsx("gov_spending_per_capita.xlsx",
                      sheet = "Share of Govt. spending",
                      skip  = 7,
                      n_max = 190,
                      na = c(". .", "xxx", "..")
                      )
```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1
#Lab 3 Q5
teacher_evals_clean <- evals |>
  rename(sex = gender) |>
  filter(no_participants >= 10) |>
  mutate(across(.cols = c(teacher_id, question_no, seniority),
                .fns = ~ as.factor(.x))) |>
  select(course_id, 
         teacher_id, 
         question_no, 
         no_participants,
         resp_share, 
         SET_score_avg, 
         percent_failed_cur, 
         academic_degree, 
         seniority, 
         sex)

```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2
#Lab 3 Q7
#Revised to remove unwanted columns rather than keep wanted ones
counts <- teacher_evals_clean |>
  distinct(teacher_id, .keep_all = TRUE) |>
  select(-course_id, -(question_no:percent_failed_cur))

```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3
#Lab 4 Q7 
#Modified to include starts_with
ca_childcare |>
select(starts_with("mc_"),
       study_year,
       region) |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
mutate(Age_class = factor(Age_class, c("Infant", "Toddler", "Preschool"))) 
```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1
#Lab 3 Q5
teacher_evals_clean <- evals |>
  rename(sex = gender) |>
  filter(no_participants >= 10) |>
  mutate(across(.cols = c(teacher_id, question_no, seniority),
                .fns = ~ as.factor(.x))) |>
  select(course_id, 
         teacher_id, 
         question_no, 
         no_participants,
         resp_share, 
         SET_score_avg, 
         percent_failed_cur, 
         academic_degree, 
         seniority, 
         sex)

```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-1
#Lab 4 Q5
ca_childcare |>
filter(study_year %in% c(2008, 2018)) |>
pivot_wider(names_from = study_year,
            values_from = mhi_2018) |> 
group_by(region) |>
summarize(`2008 median household income` = median(`2008`, na.rm = TRUE),
          `2018 median household income` = median(`2018`, na.rm = TRUE)) |>
arrange(desc(`2018 median household income`))
```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character
#Lab 4 Q2
ca_childcare <- childcare_costs |>
left_join(y = counties) |>
filter(state_name == "California")

```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string
#Lab 5 Following witness leads
get_fit_now_check_in |>
inner_join(y = get_fit_now_member,
           by = join_by(membership_id == id)) |>
inner_join(y = person,
           by = join_by(person_id == id,
                        name == name)) |>
inner_join(y = drivers_license,
           by = join_by(license_id == id))|>
  filter(membership_status == "gold",
         str_detect(plate_number, pattern = "H42W") == TRUE,
         str_detect(membership_id, pattern = "^48Z") == TRUE)

```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date
#Lab 5
#Revised to mutate date into a date object
crime_scene_report |>
mutate(date = ymd(date)) |>
filter(type == "murder",
       date == mdy("011518"),
       city == "SQL City") |>
pull(description)

```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1
#Challenge 3 Q1
teacher_evals_compare <- evals |>
filter(question_no == "903") |>
mutate(SET_level = if_else(SET_score_avg >= 4, "excellent", "standard"),
       sen_level = case_when(seniority <= 4 ~ "junior",
                             seniority > 4 & seniority < 9 ~ "senior",
                             seniority > 8 ~ "very senior")) |>
select(course_id, SET_level, sen_level)

```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2

```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1
#Lab 4 Q7
colors <- colorRampPalette(brewer.pal(7, "Accent"))(10)
ca_childcare |>
select(starts_with("mc_"),
       study_year,
       region) |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
mutate(Age_class = fct_relevel(Age_class, c("Infant", "Toddler", "Preschool"))) |>
ggplot(mapping = aes(x = study_year, 
                     y = Median_price, 
                     color = fct_reorder2(.f = region,
                                          .x = study_year,
                                          .y = Median_price))) + 
  geom_point(size = 0.5) +
  facet_wrap(~Age_class) + #https://forum.posit.co/t/re-ordering-facet-wrap/141999
  theme_bw() +
  theme(aspect.ratio = 1) +
  geom_smooth(method = loess, size = 0.5) +
  labs(x = "Study Year", 
       y = " ", 
       subtitle = "Weekly Median Price for Center Based Childcare ($)",
       color = "California Region") +
  scale_x_continuous(n.breaks = 6) +
  scale_color_manual(values = colors) +
  theme(text = element_text(size = 7)) 
```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2
#Lab 4 Q7
#revised to remove nested functions
colors <- colorRampPalette(brewer.pal(7, "Accent"))(10)
ca_childcare |>
select(starts_with("mc_"),
       study_year,
       region) |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
mutate(Age_class = fct_relevel(Age_class, c("Infant", "Toddler", "Preschool"))) |>
ggplot(mapping = aes(x = study_year, 
                     y = Median_price, 
                     color = fct_reorder2(.f = region,
                                          .x = study_year,
                                          .y = Median_price))) + 
  geom_point(size = 0.5) +
  facet_wrap(~Age_class) + #https://forum.posit.co/t/re-ordering-facet-wrap/141999
  theme_bw() +
  theme(aspect.ratio = 1) +
  geom_smooth(method = loess, size = 0.5) +
  labs(x = "Study Year", 
       y = " ", 
       subtitle = "Weekly Median Price for Center Based Childcare ($)",
       color = "California Region") +
  scale_x_continuous(n.breaks = 6) +
  scale_color_manual(values = colors) +
  theme(text = element_text(size = 7)) 

```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string
#Lab 3 Q7
#Revised to include mutating of the level names in the academic degree variable to make the table more readable
counts <- teacher_evals_clean |>
distinct(teacher_id, .keep_all = TRUE) |>
select(-course_id, -(question_no:percent_failed_cur)) |>
mutate(academic_degree = str_replace_all(academic_degree, c("dr" = "Doctorate",
                                                            "ma" = "Masters Degree",
                                                            "no_dgr" = "No Degree",
                                                            "prof" = "Professor's Degree")))

```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date
#Lab 5
crime_scene_report |>
mutate(date = ymd(date)) |>
filter(type == "murder",
       date == "2018-01-15",
       city == "SQL City") |>
pull(description)
```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1
#Lab 4 Q3
ca_childcare <- ca_childcare |>
left_join(y = tax_rev,
          by = join_by(county_name == entity_name,
                        study_year == year))
```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right
#Lab 4 Q2
ca_childcare <- counties |>
right_join(y = childcare_costs) |>
filter(state_name == "California")

```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2
#Lab 5 Inspecting witness statements
interviewpeople <- interview |>
right_join(y = person,
          by = join_by(person_id == id)) 
```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1
#Lab 5 Finding mastermind
facebook_event_checkin |>
  inner_join(y = person,
             by = join_by(person_id == id)) |>
  inner_join(y = drivers_license,
             by = join_by(license_id == id)) |>
  filter(car_make == "Tesla",
         car_model == "Model S",
         hair_color == "red",
         height >= 65 & height <= 67,
         event_name == "SQL Symphony Concert")
```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2
#Lab 5 Following witness leads
get_fit_now_check_in |>
inner_join(y = get_fit_now_member,
           by = join_by(membership_id == id)) |>
inner_join(y = person,
           by = join_by(person_id == id,
                        name == name)) |>
inner_join(y = drivers_license,
           by = join_by(license_id == id))|>
  filter(membership_status == "gold",
         str_detect(plate_number, pattern = "H42W") == TRUE,
         str_detect(membership_id, pattern = "^48Z") == TRUE)
```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi
#Lab 5
#Revised to use a semi join to filter rather than a filter statement
interviewpeople |>
  semi_join(y = new_suspect,
            by = join_by(person_id == person_id))
```

-   `anti_join()`

```{r}
#| label: wd-6-anti

```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long
#Lab 4 Q6
ca_childcare |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") 
```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide
#Lab 4 Q5
ca_childcare |>
filter(study_year %in% c(2008, 2018)) |>
pivot_wider(names_from = study_year,
            values_from = mhi_2018) |> 
group_by(region) |>
summarize(`2008 median household income` = median(`2008`, na.rm = TRUE),
          `2018 median household income` = median(`2018`, na.rm = TRUE)) |>
arrange(desc(`2018 median household income`))
```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Lab 3
-   Challenge 3
-   Lab 4
-   Challenge 4
-   Lab 5

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1
#Challenge 4 plot
colors <- c("#6C88C4", "#FF828B")
challenge |>
 mutate(year = as.factor(study_year)) |>
  ggplot(mapping = aes(x = year,
                       y = Median_price,
                       color = type_of_care)) +
          
  theme_bw() +
  geom_jitter (alpha = 0.5, aes(color = type_of_care), show.legend = FALSE) +
  geom_boxplot(outliers = FALSE) +
  labs(x = "Study Year",
       y = "",
       color = "Type of Childcare",
       subtitle = "Weekly Median Price ($) for <span style = 'color:#6C88C4;'>Center Based</span> vs <span style = 'color:#FF828B;'>Family</span> Childcare") +
    scale_color_manual(values = colors) +
    theme(legend.position = "none", 
          plot.subtitle = element_markdown(),
          panel.grid.major.x = element_blank()) 
  

```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2
#Lab 3 Q12
teacher_evals_clean |>
filter(academic_degree %in% c("dr", "prof")) |>
  group_by(teacher_id) |>
  summarize(percent_resp = mean(resp_share), 
            sex = first(sex), 
            seniority = first(seniority))|>
  filter(percent_resp == max(percent_resp) |
         percent_resp == min(percent_resp)) |>
  arrange((percent_resp))
```

-   Example of function formatting

```{r}
#| label: r-2-3
#challenge 7

replace_unlikely <- function(x, min, max){
  if (!is.numeric(x))  return(NA)
  if (!length(x) > 1) return(NA)
  
  case_when(x > max ~ NA,
            x < min ~ NA, 
            .default = x)
}
```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example
#Lab 4 Q6
ca_childcare |>
select(study_year, region, mcsa) |>
filter(study_year == 2018) |>
group_by(region) |>
summarize(mcsa = median(mcsa)) |>
ungroup() |>
filter(mcsa == min(mcsa)) 
```

-   Example (function stops)

```{r}
#| label: r-3-function-stops

```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num
#Lab 4 Q8

#We will talk tomorrow (September 25) about themes and why theme_classic() is not a theme I would recommend using. Please take note!

ca_childcare |>
ggplot(mapping = aes(x = mhi_2018, y = mc_infant)) +
geom_point() +
geom_smooth(method = "lm", color = "salmon") +
  theme_bw() +
  labs(x = "Median Household Income ($)",
       y = "",
       subtitle = "Weekly Median Price for Center Based Childcare for an Infant ($)")
```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-2-num-cat
#Challenge 2 

colors<-c("#f07857", "#4895ef" )
ggplot(data = surveys,
       mapping = aes(x = weight, y = species)) +
  geom_jitter( alpha = 0.5) +
  geom_boxplot(outliers = FALSE, mapping = aes(color = sex)) +
  labs(x = "Weight (g)", y = "Species", color = "Sex",
       subtitle = "<span style = 'color:#f07857;'>Female</span> vs <span style = 'color:#4895ef;'>Male</span> rodent species weights") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        legend.position = "none", 
        plot.subtitle = element_markdown(size = 15),
        axis.ticks.y = element_blank(),
        axis.text.x = element_text(size = 9), 
        axis.text.y = element_text(size = 9)) +
scale_color_manual(values = colors)   
```

-   At least two categorical variables

```{r}
#| label: dvs-2-cat
#Lab 7

colors <- c("coral1", "cornflowerblue")

trout |>
 filter(if_any(.cols = everything(),  
               .fns = ~ is.na(.x))) |>
  mutate(trip = as.factor(trip),
         year = as.factor(year)) |>
  mutate(trip = fct_recode(trip, `Trip 1` = "1", `Trip 2` = "2")) |>
  ggplot(mapping = aes(x = year, fill = section)) +
    geom_bar(stat = "count", position = "dodge") +
  facet_wrap("trip") +
  theme_bw() +
  scale_fill_manual(values = colors) +
  labs(x = "Year", 
       y = "",
       title = "Missing Values for Trout Length by Year, Trip, and Section",
       subtitle = "Number of NAs by Year",
       fill = "Section") +
   theme(text = element_text(size = 9)) 
```

-   Dates (time series plot)

```{r}
#| label: dvs-2-date
#Lab 4 Q7

#I strongly recommend against nested functions, as they are difficult for people to understand what your code is doing. Having two lines is not less efficient and is more readable.

colors <- colorRampPalette(brewer.pal(7, "Accent"))(10)
ca_childcare |>
select(starts_with("mc_"),
       study_year,
       region) |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
mutate(Age_class = fct_relevel(Age_class, c("Infant", "Toddler", "Preschool"))) |>
ggplot(mapping = aes(x = study_year, 
                     y = Median_price, 
                     color = fct_reorder2(.f = region,
                                          .x = study_year,
                                          .y = Median_price))) + 
  geom_point(size = 0.5) +
  facet_wrap(~Age_class) + #https://forum.posit.co/t/re-ordering-facet-wrap/141999
  theme_bw() +
  theme(aspect.ratio = 1) +
  geom_smooth(method = loess, size = 0.5) +
  labs(x = "Study Year", 
       y = " ", 
       subtitle = "Weekly Median Price for Center Based Childcare ($)",
       color = "California Region") +
  scale_x_continuous(n.breaks = 6) +
  scale_color_manual(values = colors) +
  theme(text = element_text(size = 7)) 
```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1
#Challenge 2
#Nice work! These both can go inside the same call to the theme() function! 
colors<-c("#f07857", "#4895ef" )
ggplot(data = surveys,
       mapping = aes(x = weight, y = species)) +
  geom_jitter( alpha = 0.5) +
  geom_boxplot(outliers = FALSE, mapping = aes(color = sex)) +
  labs(x = "Weight (g)", y = "Species", color = "Sex",
       subtitle = "<span style = 'color:#f07857;'>Female</span> vs <span style = 'color:#4895ef;'>Male</span> rodent species weights") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        legend.position = "none", 
        plot.subtitle = element_markdown(size = 15),
        axis.ticks.y = element_blank(),
        axis.text.x = element_text(size = 9), 
        axis.text.y = element_text(size = 9)) +
scale_color_manual(values = colors)   
```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2
#Challenge 2
colors<-c("#f07857", "#4895ef" )
ggplot(data = surveys,
       mapping = aes(x = weight, y = species)) +
  geom_jitter( alpha = 0.5) +
  geom_boxplot(outliers = FALSE, mapping = aes(color = sex)) +
  labs(x = "Weight (g)", y = "Species", color = "Sex",
       subtitle = "<span style = 'color:#f07857;'>Female</span> vs <span style = 'color:#4895ef;'>Male</span> rodent species weights") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        legend.position = "none", 
        plot.subtitle = element_markdown(size = 15),
        axis.ticks.y = element_blank(),
        axis.text.x = element_text(size = 9), 
        axis.text.y = element_text(size = 9)) +
scale_color_manual(values = colors)  
```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3
#Challenge 4 Plot
colors <- c("#6C88C4", "#FF828B")
challenge |>
 mutate(year = as.factor(study_year)) |>
  ggplot(mapping = aes(x = year,
                       y = Median_price,
                       color = type_of_care)) +
          
  theme_bw() +
  geom_jitter (alpha = 0.5, aes(color = type_of_care), show.legend = FALSE) +
  geom_boxplot(outliers = FALSE) +
  labs(x = "Study Year",
       y = "",
       color = "Type of Childcare",
       subtitle = "Weekly Median Price ($) for <span style = 'color:#6C88C4;'>Center Based</span> vs <span style = 'color:#FF828B;'>Family</span> Childcare") +
    scale_color_manual(values = colors) +
    theme(legend.position = "none", 
          plot.subtitle = element_markdown(),
          panel.grid.major.x = element_blank()) 
  
```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4
#Challenge 2
colors<-c("#f07857", "#4895ef" )
ggplot(data = surveys,
       mapping = aes(x = weight, y = species)) +
  geom_jitter( alpha = 0.5) +
  geom_boxplot(outliers = FALSE, mapping = aes(color = sex)) +
  labs(x = "Weight (g)", y = "Species", color = "Sex",
       subtitle = "<span style = 'color:#f07857;'>Female</span> vs <span style = 'color:#4895ef;'>Male</span> rodent species weights") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        legend.position = "none", 
        plot.subtitle = element_markdown(size = 15),
        axis.ticks.y = element_blank(),
        axis.text.x = element_text(size = 9), 
        axis.text.y = element_text(size = 9)) +
scale_color_manual(values = colors) 
```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5

#Lab 4 Q7 

#Could you relevel the age variable **before** you use it for facetting?

colors <- colorRampPalette(brewer.pal(7, "Accent"))(10)
ca_childcare |>
select(starts_with("mc_"),
       study_year,
       region) |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
mutate(Age_class = fct_relevel(Age_class, c("Infant", "Toddler", "Preschool"))) |>
ggplot(mapping = aes(x = study_year, 
                     y = Median_price, 
                     color = fct_reorder2(.f = region,
                                          .x = study_year,
                                          .y = Median_price))) + 
  geom_point(size = 0.5) +
  facet_wrap(~Age_class) + #https://forum.posit.co/t/re-ordering-facet-wrap/141999
  theme_bw() +
  theme(aspect.ratio = 1) +
  geom_smooth(method = loess, size = 0.5) +
  labs(x = "Study Year", 
       y = " ", 
       subtitle = "Weekly Median Price for Center Based Childcare ($)",
       color = "California Region") +
  scale_x_continuous(n.breaks = 6) +
  scale_color_manual(values = colors) +
  theme(text = element_text(size = 7)) 
```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1
#Challenge 4 Plot
colors <- c("#6C88C4", "#FF828B")
challenge |>
 mutate(year = as.factor(study_year)) |>
  ggplot(mapping = aes(x = year,
                       y = Median_price,
                       color = type_of_care)) +
          
  theme_bw() +
  geom_jitter (alpha = 0.5, aes(color = type_of_care), show.legend = FALSE) +
  geom_boxplot(outliers = FALSE) +
  labs(x = "Study Year",
       y = "",
       color = "Type of Childcare",
       subtitle = "Weekly Median Price ($) for <span style = 'color:#6C88C4;'>Center Based</span> vs <span style = 'color:#FF828B;'>Family</span> Childcare") +
    scale_color_manual(values = colors) +
  theme(legend.position = "none", 
        plot.subtitle = element_markdown(),
        panel.grid.major.x = element_blank()) 
```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2
#Lab 4 Q7


#Can you match my colors??? These are coming from a package and you will need to expand the color palette to get all 10 colors.

colors <- colorRampPalette(brewer.pal(7, "Accent"))(10)

ca_childcare |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
ggplot(mapping = aes(x = study_year, 
                     y = Median_price, 
                     color = fct_reorder2(.f = region,
                                          .x = study_year,
                                          .y = Median_price))) + 
  geom_point(size = 0.5) +
  facet_wrap(~factor(Age_class, c("Infant", "Toddler", "Preschool"))) + #https://forum.posit.co/t/re-ordering-facet-wrap/141999
  theme_bw() +
  theme(aspect.ratio = 1) +
  geom_smooth(method = loess, size = 0.5) +
  labs(x = "Study Year", 
       y = " ", 
       subtitle = "Weekly Median Price for Center Based Childcare ($)",
       color = "California Region") +
  scale_x_continuous(n.breaks = 6) +
  scale_color_manual(values = colors) +
  theme(text = element_text(size = 7)) 
```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2
#Challenge 3 Q2
#Revised to practice adding labels to a stacked bar chart
colors <- c("#b796d4", "#ba955c")
ggplot(data = teacher_evals_compare, mapping = aes(x = sen_level, fill = SET_level, label = SET_level)) +
geom_bar(position = "fill", ) +
labs(x = "Years of Experience",
     title = "Evaluation of Teacher's Use of Activities",
     fill = "Evaluation Rating") +
theme_bw() +
geom_text(aes(label = SET_level),
              stat = "count", 
              position = position_fill(vjust = 0.5)) + #https://stackoverflow.com/questions/12018499/how-to-put-labels-over-geom-bar-for-each-bar-in-r-with-ggplot2
scale_fill_manual(values = colors) + 
scale_y_continuous(labels = scales::percent) +
#https://stackoverflow.com/questions/27433798/how-can-i-change-the-y-axis-figures-into-percentages-in-a-barplot
theme(legend.position = "top") #https://r-graph-gallery.com/239-custom-layout-legend-ggplot2.html
```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3
#Challenge 4
#Revised - I tried using a new geom to show similar information as my original graph but in a way that may be more clear to the viewer.
colors <- c("#6C88C4", "#FF828B")
challenge |>
  select(type_of_care, Median_price, study_year) |>
  group_by(type_of_care, study_year) |>
  summarize(Mean = mean(Median_price),
            sd = sd(Median_price),
            type_of_care = type_of_care,
            .groups = "drop") |>
  mutate(ymin = Mean - sd,
         ymax = Mean + sd) |>
  ggplot(aes(x = study_year, y = Mean, color = type_of_care, fill = type_of_care)) +
  geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = type_of_care), 
              alpha = 0.2, color = NA) +
  theme_bw() +
  geom_line(size = 1) +
  labs(x = "Study Year",
       y = "",
       color = "Type of Childcare",
       subtitle = "Weekly Median Price ($) for <span style = 'color:#6C88C4;'>Center Based</span> vs <span style = 'color:#FF828B;'>Family</span> Childcare") +
    scale_color_manual(values = colors) +
    scale_fill_manual(values = colors) +
    theme(legend.position = "none", 
          plot.subtitle = element_markdown(),
          panel.grid.minor.x = element_blank()) +
    scale_x_continuous(n.breaks = 11)
```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize
#Lab 3 Q6

summarize(teacher_evals_clean, 
          n_distinct(teacher_id),
          n_distinct(course_id))

```

-   Example using `across()`

```{r}
#| label: dvs-4-across
#Lab 7 Q1

trout_nas <- trout |>
  summarise(across(.cols = everything(), 
                   .fns = ~sum(is.na(.x))))

```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1
#Lab 3 Q9
#Modified to use summarize instead of count

teacher_evals_clean |>
  group_by(course_id, teacher_id)|>
  summarize(questions = sum(n_distinct(question_no)), .groups = "drop") |>
  filter(questions == 9)

```

-   Example 2

```{r}
#| label: dvs-5-2
#Lab 4 Q5

#I would recommend using the %in% operator instead of the or!
#Can you give your column names better titles, so the reader knows what "2008" and "2018" represent? What are the values stored in these columns?

ca_childcare |>
filter(study_year %in% c(2008, 2018)) |>
pivot_wider(names_from = study_year,
            values_from = mhi_2018) |> 
group_by(region) |>
summarize(`2008 median household income` = median(`2008`, na.rm = TRUE),
          `2018 median household income` = median(`2018`, na.rm = TRUE)) |>
arrange(desc(`2018 median household income`))
```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1
#Lab 4 Q5


#Can you give your column names better titles, so the reader knows what "2008" and "2018" represent? What are the values stored in these columns?

ca_childcare |>
filter(study_year %in% c(2008, 2018)) |>
pivot_wider(names_from = study_year,
            values_from = mhi_2018) |> 
group_by(region) |>
summarize(`2008 median household income` = median(`2008`, na.rm = TRUE),
          `2018 median household income` = median(`2018`, na.rm = TRUE)) |>
arrange(desc(`2018 median household income`))
```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2

```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3
#Lab 4 Q5

ca_childcare |>
filter(study_year %in% c(2008, 2018)) |>
pivot_wider(names_from = study_year,
            values_from = mhi_2018) |> 
group_by(region) |>
summarize(`2008 median household income` = median(`2008`, na.rm = TRUE),
          `2018 median household income` = median(`2018`, na.rm = TRUE)) |>
arrange(desc(`2018 median household income`))
```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1

```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2

```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call
#Lab 5 Finding mastermind

facebook_event_checkin |>
  inner_join(y = person,
             by = join_by(person_id == id)) |>
  inner_join(y = drivers_license,
             by = join_by(license_id == id)) |>
  filter(car_make == "Tesla",
         car_model == "Model S",
         hair_color == "red",
         height >= 65 & height <= 67,
         event_name == "SQL Symphony Concert")
```

-   using `across()`

```{r}
#| label: pe-1-across
#Lab 3 Q5
teacher_evals_clean <- evals |>
  rename(sex = gender) |>
  filter(no_participants >= 10) |>
  mutate(across(.cols = c(teacher_id, question_no, seniority),
                .fns = ~ as.factor(.x))) |>
  select(course_id, 
         teacher_id, 
         question_no, 
         no_participants,
         resp_share, 
         SET_score_avg, 
         percent_failed_cur, 
         academic_degree, 
         seniority, 
         sex)
```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1
#Lab 9 Q2

surveys|>
  map_chr(.f = ~ class(.x)) |>
  enframe()
```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1

```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2

```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3

```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across
#Lab 3 Q8

#Your code does a great job filtering across multiple columns. However, the formatting of your code could use a bit of help. Specifically, I would love to see you using named argments and the correct function syntax for the if_any() function:


teacher_evals_clean |>
  filter(if_any(.cols = everything(),  
                .fns = ~ is.na(.x)))
```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1

```

-   using a `map()` function with **more than one** input (e.g., `map_2()` or `pmap()`)

```{r}
#| label: pe-3-map-2

```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1
#Lab 3 Q8

teacher_evals_clean |>
  filter(if_any(.cols = everything(),  
                .fns = ~ is.na(.x)))
```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2
#Lab 4 Q6

colors <- colorRampPalette(brewer.pal(7, "Accent"))(10)
ca_childcare |>
select(starts_with("mc_"),
       study_year,
       region) |>
rename(Infant = mc_infant,
       Toddler = mc_toddler,
       Preschool = mc_preschool ) |>
pivot_longer(cols = Infant: Preschool, 
             names_to = "Age_class", 
             values_to = "Median_price") |>
mutate(Age_class = fct_relevel(Age_class, c("Infant", "Toddler", "Preschool"))) |>
ggplot(mapping = aes(x = study_year, 
                     y = Median_price, 
                     color = fct_reorder2(.f = region,
                                          .x = study_year,
                                          .y = Median_price))) + 
  geom_point(size = 0.5) +
  facet_wrap(~Age_class) + #https://forum.posit.co/t/re-ordering-facet-wrap/141999
  theme_bw() +
  theme(aspect.ratio = 1) +
  geom_smooth(method = loess, size = 0.5) +
  labs(x = "Study Year", 
       y = " ", 
       subtitle = "Weekly Median Price for Center Based Childcare ($)",
       color = "California Region") +
  scale_x_continuous(n.breaks = 6) +
  scale_color_manual(values = colors) +
  theme(text = element_text(size = 7)) 
```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1

```

-   Example 2

```{r}
#| label: dsm-1-2

```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

```{r}
#| label: dsm-2-1
#Lab 2 Q17

#Do you need to save an object here? All I want is to see the output...

summary(aov(weight~species, data = surveys))
```

-   Example 2

```{r}
#| label: dsm-2-2
#Lab 1 Q9

t.test(len ~ supp, data = ToothGrowth)
```

-   Example 3

```{r}
#| label: dsm-2-3
#Challenge 3 Q3

#This works, but did you need to make a contingency table? Could you have input these vectors directly into the chisq.test() function?

#Revised to not include a contingency table

chisq.test(teacher_evals_compare$SET_level,
           teacher_evals_compare$sen_level)
```

## Revising My Thinking

<!-- How did you revise your thinking throughout the course? How did you revise your thinking on the code examples you have provided in your portfolio? -->

Throughout this class, I have revised my thinking by doing revisions on my lab and challenge assignments, and by incorporating feedback I got into future assignments. I submitted revisions for all the assignments I received growings on that involved more than a quick fix. For smaller things like formatting or switching an operation, I made sure to incorporate those changes into my next assignments, while for more major issues, I revised my work and resubmitted it to better understand what I did wrong and whether I had successfully improved it. For all of my revisions I made sure to fully understand why I needed to revise it, and how my revised code was better than the original. I also improved my tidy code writing skills throughout the course using the feedback I got from peer code reviews.

I included feedback that I received in the sections of the portfolio where I showed how I incorporated that feedback into my code. I also specified the parts I revised for this portfolio.

<!-- For the revisions included in your Portfolio, to help me understand the nature of your revisions, please denote somehow the feedback I provided you (e.g., boldface, italics, colored text) before your revisions. -->

## Extending My Thinking

<!-- How did you extended your thinking throughout the course? How did you extend your thinking on the code examples you have provided in your portfolio? -->

Throughout this course, I worked on extending my thinking by combining different skills that we have learned to make my code as efficient and effective as possible. I asked questions in class to ensure that I fully understood what I was doing with my code and to clarify how could improve it. I have pushed myself on the challenge assignments as well, for example in in Challenge 2 I tried to combine all 3 of the options to make a unique and easy to read plot. During the lab and challenge activities, if there was something I was struggling to do, I either asked questions or did research online in order to figure out the best way to do it.

## Peer Support & Collaboration

<!-- Include an image or a description of feedback you gave that you are proud of (either in a peer review or in Discord). -->

This was a code review that I gave for lab 5: Overall your code looks really good! You did a great job following the tidy code guidelines; you used named arguments, ended lines with pipes and didn't let any lines of code get too long. You also did a great job leaving spaces around all operators. The only note I have is that you saved a lot of objects that you don't necessarily need in this situation. For example when finding the first two witness interviews, and finding further information about the people seen at the gym, you don't need to save an object and print it each time, you could have the pipeline directly output the information you want by just removing the assignment operation. This would just declutter your code a bit, but other than that I thought it looked great!

<!-- Include a description of how you grew as a collaborator through the weekly pair programming activities.   -->

For the practice activities, it was kind of tricky at the very beginning to get used to the alternating roles, but after the first time I felt like I got a lot better at both clearly explaining my thoughts when I was the developer, and following my partner's ideas when I was the coder. In particular, I got a lot more comfortable with just trying something to see if it worked before giving my own input on whether I thought it would work or not. This helped me to be more open to different ways to do things, and I got better at waiting to offer input until I was asked. Working with a partner, seeing someone else's way of doing things, and talking through problems was also really helpful in learning and getting better at using the methods we learned in class.
